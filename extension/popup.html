<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      width: 300px;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: #0a0a0f;
      color: #e5e5e5;
      padding: 20px;
    }

    /* Header */
    .header {
      text-align: center;
      margin-bottom: 20px;
    }
    .header h1 {
      font-size: 20px;
      font-weight: 700;
      color: #fff;
    }

    /* ---- Login Screen ---- */
    #loginSection { display: none; }
    .login-hint {
      font-size: 13px;
      color: #999;
      text-align: center;
      margin-bottom: 14px;
      line-height: 1.4;
    }
    .token-input {
      width: 100%;
      padding: 12px;
      background: #13131a;
      border: 1px solid #333;
      border-radius: 8px;
      color: #fff;
      font-size: 14px;
      outline: none;
      margin-bottom: 10px;
      text-align: center;
    }
    .token-input:focus { border-color: #3b82f6; }
    .token-input::placeholder { color: #555; }
    #loginMsg {
      font-size: 12px;
      text-align: center;
      margin-bottom: 8px;
    }
    .msg-error { color: #f87171; }
    .msg-success { color: #4ade80; }
    .btn-connect {
      width: 100%;
      padding: 12px;
      background: #3b82f6;
      color: #fff;
      border: none;
      border-radius: 8px;
      font-size: 15px;
      font-weight: 600;
      cursor: pointer;
    }
    .btn-connect:hover { background: #2563eb; }
    .advanced-toggle {
      display: block;
      width: 100%;
      text-align: center;
      font-size: 11px;
      color: #555;
      background: none;
      border: none;
      cursor: pointer;
      margin-top: 12px;
      padding: 4px;
    }
    .advanced-toggle:hover { color: #888; }
    .advanced-section {
      display: none;
      margin-top: 8px;
    }
    .advanced-section.show { display: block; }
    .server-input {
      width: 100%;
      padding: 8px 10px;
      background: #13131a;
      border: 1px solid #222;
      border-radius: 6px;
      color: #aaa;
      font-size: 11px;
      font-family: monospace;
      outline: none;
    }
    .server-input:focus { border-color: #3b82f6; color: #fff; }

    /* ---- Main Screen ---- */
    #mainSection { display: none; }

    .big-status {
      text-align: center;
      padding: 12px 0 8px;
    }
    .status-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      display: inline-block;
      margin-right: 6px;
      position: relative;
      top: 0px;
    }
    .status-dot.on { background: #4ade80; box-shadow: 0 0 8px #4ade8066; }
    .status-dot.off { background: #facc15; box-shadow: 0 0 8px #facc1566; }
    .status-dot.busy { background: #3b82f6; box-shadow: 0 0 8px #3b82f666; animation: pulse-dot 1.5s infinite; }
    .status-text {
      font-size: 16px;
      font-weight: 700;
      color: #fff;
    }

    /* Activity feed */
    .activity {
      text-align: center;
      font-size: 12px;
      color: #888;
      padding: 4px 0 14px;
      min-height: 28px;
    }
    .activity.active { color: #60a5fa; }

    .stats {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-bottom: 16px;
    }
    .stat {
      text-align: center;
    }
    .stat-num {
      font-size: 22px;
      font-weight: 700;
      color: #fff;
    }
    .stat-num.green { color: #4ade80; }
    .stat-num.red { color: #f87171; }
    .stat-num.yellow { color: #facc15; }
    .stat-label {
      font-size: 10px;
      color: #666;
      margin-top: 2px;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .btn-main {
      width: 100%;
      padding: 10px;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      font-weight: 600;
      cursor: pointer;
      margin-bottom: 8px;
    }
    .btn-main.running {
      background: #1a1a24;
      color: #facc15;
      border: 1px solid #333;
    }
    .btn-main.stopped {
      background: #4ade80;
      color: #000;
    }
    .btn-main:hover { opacity: 0.9; }
    .btn-disconnect {
      display: block;
      width: 100%;
      text-align: center;
      font-size: 11px;
      color: #444;
      background: none;
      border: none;
      cursor: pointer;
      padding: 6px;
      margin-top: 4px;
    }
    .btn-disconnect:hover { color: #f87171; }

    @keyframes pulse-dot {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.4; }
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>CommentFlow</h1>
  </div>

  <!-- Login: just paste token and go -->
  <div id="loginSection">
    <p class="login-hint">Paste the token from your dashboard</p>
    <input type="text" class="token-input" id="tokenInput" placeholder="Token">
    <div id="loginMsg"></div>
    <button class="btn-connect" id="connectBtn">Connect</button>
    <button class="advanced-toggle" id="advancedToggle">Server settings</button>
    <div class="advanced-section" id="advancedSection">
      <input type="text" class="server-input" id="serverUrl" value="http://localhost:3000" placeholder="http://localhost:3000">
    </div>
  </div>

  <!-- Main: live status + stats + toggle -->
  <div id="mainSection">
    <div class="big-status">
      <span class="status-dot on" id="statusDot"></span>
      <span class="status-text" id="statusText">Running</span>
    </div>
    <div class="activity" id="activityText">Idle</div>

    <div class="stats">
      <div class="stat">
        <div class="stat-num yellow" id="queueCount">0</div>
        <div class="stat-label">Queued</div>
      </div>
      <div class="stat">
        <div class="stat-num green" id="postedCount">0</div>
        <div class="stat-label">Posted</div>
      </div>
      <div class="stat">
        <div class="stat-num red" id="failedCount">0</div>
        <div class="stat-label">Failed</div>
      </div>
    </div>

    <button class="btn-main running" id="toggleBtn">Pause</button>
    <button class="btn-disconnect" id="disconnectBtn">Disconnect</button>
  </div>

  <script src="popup.js"></script>
</body>
</html>
